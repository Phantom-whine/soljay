{% extends "auth/base.html" %}
{% block title %} Create an account {% endblock %}
{% block content %}
<div class="bg-white p-8 rounded-lg shadow-md w-full max-w-md" x-data="registerForm()">
    <div class="text-center mb-8">
        <img src="/api/placeholder/200/80" alt="Company Logo" class="mx-auto mb-4">
        <h2 class="text-2xl font-bold text-gray-800">Create an Account</h2>
    </div>
    
    <form @submit.prevent="submitForm">
        <div class="mb-4">
            <label for="email" class="block text-gray-700 text-sm font-bold mb-2">Email</label>
            <input type="email" id="email" name="email" x-model="email" @blur="checkEmail" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
        </div>
        
        <div class="mb-4">
            <label for="password" class="block text-gray-700 text-sm font-bold mb-2">Password</label>
            <input type="password" name="password" id="password" x-model="password" @input="checkPasswordStrength" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
            <div class="mt-2">
                <div class="h-2 rounded-full bg-gray-200 overflow-hidden">
                    <div :class="strengthBarClass" :style="{ width: `${passwordStrength}%` }" class="h-full transition-all duration-300"></div>
                </div>
                <p x-text="strengthText" class="text-xs mt-1" :class="strengthTextClass"></p>
            </div>
        </div>
        
        <div class="mb-6">
            <label for="confirm-password" class="block text-gray-700 text-sm font-bold mb-2">Confirm Password</label>
            <input type="password" id="confirm-password" x-model="confirmPassword" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
            <p x-show="!passwordsMatch && confirmPassword" class="text-red-500 text-xs mt-1">Passwords do not match</p>
        </div>
        
        <button type="submit" class="w-full bg-blue-500 text-white font-bold py-2 px-4 rounded-md hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 transition-colors duration-300">
            Register
        </button>
    </form>
    
    <p class="text-center mt-4 text-sm text-gray-600">
        Already have an account? <a href="#" class="text-blue-500 hover:underline">Log in</a>
    </p>
</div>

<script>
    function registerForm() {
        return {
            email: '',
            password: '',
            confirmPassword: '',
            emailError: '',
            passwordStrength: 0,
            
            checkPasswordStrength() {
                const strongRegex = new RegExp("^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#\$%\^&\*])(?=.{8,})");
                const mediumRegex = new RegExp("^(((?=.*[a-z])(?=.*[A-Z]))|((?=.*[a-z])(?=.*[0-9]))|((?=.*[A-Z])(?=.*[0-9])))(?=.{6,})");
                
                if (strongRegex.test(this.password)) {
                    this.passwordStrength = 100;
                } else if (mediumRegex.test(this.password)) {
                    this.passwordStrength = 50;
                } else {
                    this.passwordStrength = 25;
                }
            },
            
            get strengthText() {
                if (this.passwordStrength === 100) return 'Strong';
                if (this.passwordStrength === 50) return 'Medium';
                return 'Weak';
            },
            
            get strengthTextClass() {
                if (this.passwordStrength === 100) return 'text-green-500';
                if (this.passwordStrength === 50) return 'text-yellow-500';
                return 'text-red-500';
            },
            
            get strengthBarClass() {
                if (this.passwordStrength === 100) return 'bg-green-500';
                if (this.passwordStrength === 50) return 'bg-yellow-500';
                return 'bg-red-500';
            },
            
            get passwordsMatch() {
                return this.password === this.confirmPassword;
            },
            
            submitForm() {
                if (this.emailError || !this.passwordsMatch) {
                    alert('Please fix the errors before submitting.');
                    return;
                }
            }
        }
    }
</script>
{% endblock %}